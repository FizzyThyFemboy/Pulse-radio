<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Pulse Radio - The Heartbeat of Music. Streaming 24/7 for gamers and developers.">
    <title>Pulse Radio | The Heartbeat of Music</title>
    
    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="styles.css">
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;800&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>

    <!-- Ambient Background Element -->
    <div class="glow-orb"></div>

    <!-- Floating Navigation -->
    <nav>
        <a onclick="showSection('home')" class="nav-logo">
            <div class="pulse-dot"></div> Pulse
        </a>
        <div class="nav-links">
            <a onclick="showSection('home')" class="active" id="nav-home">Tune In</a>
            <a href="#about" onclick="showSection('home')">About</a>
            <a href="#features" onclick="showSection('home')">Features</a>
            <a onclick="showSection('team')" id="nav-team">Meet The Team</a>
        </div>
        <a href="https://discord.gg/Tqv94pyQYS" target="_blank" style="color:white; text-decoration:none; font-size: 1.2rem;">
            <i class="fab fa-discord"></i>
        </a>
    </nav>

    <!-- WRAPPER FOR HOME CONTENT -->
    <div id="section-home" class="view-section">
        <!-- Hero Section -->
        <div class="hero" id="home">
            <h1>Digital<br>Heartbeat.</h1>
            <p>High-fidelity audio streaming for the coding generation.</p>
            
<div class="player-wrapper">
    <div class="player-card" id="playerCard">
        <div class="player-inner">
            <div class="visualizer">
                <div class="bar"></div>
                <div class="bar"></div>
                <div class="bar"></div>
                <div class="bar"></div>
                <div class="bar"></div>
            </div>

            <!-- Audio Element with ID 'stream' -->
            <audio id="stream" preload="none"></audio>

            <button class="play-btn" id="playButton" onclick="handlePlayClick()">
                <i class="fas fa-play" id="icon"></i>
            </button>
            
            <div class="status" id="status">System Standby</div>

            <div class="song-info">
                <h2 id="songTitle">Waiting for Signal...</h2>
                <div class="artist-name" id="songArtist">Pulse Radio Network</div>

                <!-- NEW LISTENER COUNT -->
                <div id="listenerCount" style="
                    font-family: 'JetBrains Mono', monospace; 
                    color: var(--primary); 
                    font-size: 0.85rem; 
                    margin-top: 10px; 
                    opacity: 0.9; 
                    display: flex; 
                    align-items: center; 
                    justify-content: center; 
                    gap: 8px;
                    background: rgba(255, 255, 255, 0.05);
                    padding: 5px 12px;
                    border-radius: 15px;
                    width: fit-content;
                    margin-left: auto;
                    margin-right: auto;
                ">
                    <i class="fas fa-users"></i> <span>-- Listeners</span>
                </div>
            </div>

                        <div class="volume-container">
                            <i class="fas fa-volume-down" style="font-size: 0.8rem;"></i>
                            <input type="range" min="0" max="1" step="0.01" value="0.5" class="volume-slider" id="volumeSlider">
                            <i class="fas fa-volume-up" style="font-size: 0.8rem;"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Features -->
        <div class="section" id="features">
            <div class="section-header">
                <h2>System Specs</h2>
                <p>Built for performance and uptime.</p>
            </div>
            
            <div class="grid-3">
                <div class="feature-card">
                    <i class="fas fa-broadcast-tower"></i>
                    <h3>24/7 Uptime</h3>
                    <p>Redundant stream servers ensure the music never stops, even during your late-night debugging sessions.</p>
                </div>
                <div class="feature-card">
                    <i class="fas fa-wave-square"></i>
                    <h3>320kbps Audio</h3>
                    <p>Crystal clear, high-bitrate audio delivery. No compression artifacts, just pure sound.</p>
                </div>
                <div class="feature-card">
                    <i class="fas fa-terminal"></i>
                    <h3>Open Request</h3>
                    <p>Control the playlist via our Discord bot. Community-curated tracks voted by listeners.</p>
                </div>
            </div>
        </div>

        <!-- About Section -->
        <div class="section" id="about">
            <div class="grid-2">
                <div>
                    <h2 style="text-align: left;">The Network</h2>
                    <p style="color: var(--text-muted); margin-bottom: 20px;">
                        Pulse Radio isn't just a playlistâ€”it's infrastructure. We operate a dedicated broadcasting node in NSW, Australia, designed to deliver low-latency audio to listeners worldwide.
                    </p>
                    <p style="color: var(--text-muted);">
                        Whether you are coding a new react app, grinding an RPG, or just chilling, our frequency adapts to your workflow.
                    </p>
                </div>
                <div class="stats-box">
                    <h3 style="color: var(--primary); margin-top: 0; font-family: 'JetBrains Mono';">/// STATUS_REPORT</h3>
                    <div style="display: flex; justify-content: space-between; margin-top: 40px;">
                        <div class="stat-item">
                            <strong>99.9%</strong>
                            <span style="font-size: 0.8rem; color: #666; text-transform:uppercase; letter-spacing:1px;">Availability</span>
                        </div>
                        <div class="stat-item">
                            <strong>0$</strong>
                            <span style="font-size: 0.8rem; color: #666; text-transform:uppercase; letter-spacing:1px;">Cost</span>
                        </div>
                        <div class="stat-item">
                            <strong>Inf</strong>
                            <span style="font-size: 0.8rem; color: #666; text-transform:uppercase; letter-spacing:1px;">Vibes</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Discord -->
        <div class="section" id="community">
            <div class="discord-section">
                <i class="fab fa-discord" style="font-size: 3.5rem; color: #5865F2; margin-bottom: 20px; filter: drop-shadow(0 0 20px rgba(88,101,242,0.4));"></i>
                <h2>Join the Neural Network</h2>
                <p style="max-width: 600px; margin: 10px auto; color: var(--text-muted);">
                    Connect with the community, access the DJ bot, and participate in server events.
                </p>
                <a href="https://discord.gg/GDT8pZ5vRs" target="_blank" class="btn-discord">
                    <span>Enter Discord</span> <i class="fas fa-arrow-right"></i>
                </a>
            </div>
        </div>
    </div>
    <!-- END HOME WRAPPER -->


    <!-- WRAPPER FOR TEAM CONTENT (Hidden by default) -->
    <div id="section-team" class="view-section hidden">
        <!-- Header -->
        <div class="page-header">
            <h1>Command Center</h1>
            <p>The architects behind the frequency.</p>
        </div>

        <!-- TIER 1: Executive Leadership -->
        <div class="container">
            <div class="tier-label">/// ROOT_ACCESS</div>
            
            <div class="tier-grid">
                <!-- ColourfulPlanets -->
                <div class="team-card rank-exec">
                    <div class="pfp-wrapper">
                        <img src="https://cdn.discordapp.com/avatars/1023108830760009768/6d9676be4cc8ab1a0e34f8d5e34195cb.png?size=512" alt="ColourfulPlanets">
                    </div>
                    <span class="role-badge">Founder & Lead Dev</span>
                    <h3 class="member-name">ColourfulPlanets</h3>
                    <p class="member-bio">
                        Architect of the Pulse infrastructure. Full-stack developer specializing in Discord bot systems, web dashboards, and network engineering.
                    </p>
                    <div style="margin-bottom: 40px;"></div>
                    
                    <div class="skills-container">
                        <div class="skills-ticker">
                            <span><i class="fab fa-js"></i>JavaScript</span> 
                            <span><i class="fab fa-react"></i>React</span> 
                            <span>Next.js</span> 
                            <span><i class="fab fa-node-js"></i>Node.js</span> 
                            <span>MongoDB</span> 
                            <span><i class="fab fa-python"></i>Python</span> 
                            <span><i class="fab fa-aws"></i>AWS</span> 
                            <span>Discord.js</span>
                            <span>Lua</span>
                            <span><i class="fab fa-js"></i>JavaScript</span> 
                            <span><i class="fab fa-react"></i>React</span> 
                            <span>Next.js</span> 
                            <span><i class="fab fa-node-js"></i>Node.js</span> 
                            <span>MongoDB</span> 
                        </div>
                    </div>
                </div>
            </div>

            <!-- TIER 2: Management Team -->
            <div class="tier-label">/// SYS_ADMINS</div>
            
            <div class="tier-grid">
                <!-- creepey_me -->
                <div class="team-card rank-mgmt">
                    <div class="pfp-wrapper">
                        <img src="https://cdn.discordapp.com/avatars/833717336476745728/a063a2ec2bbb82f42e6c0fa4327881f9.png?size=512" alt="creepey_me">
                    </div>
                    <span class="role-badge">Station Manager</span>
                    <h3 class="member-name">creepey_me</h3>
                    <p class="member-bio">
                        Operations Lead. Orchestrates staff training, event schedules, and ensures daily broadcast operations run seamlessly.
                    </p>
                </div>

                <!-- weeeeeeeeeeeeeeee_weee -->
                <div class="team-card rank-mgmt">
                    <div class="pfp-wrapper">
                        <img src="https://cdn.discordapp.com/avatars/866208706600501268/88dc69125cb370588092596f240e1717.png?size=512" alt="weee">
                    </div>
                    <span class="role-badge">Program Director</span>
                    <h3 class="member-name">weeeee_weee</h3>
                    <p class="member-bio">
                        Content Curator. Selects the high-rotation playlists and directs the overall station vibe for maximum flow.
                    </p>
                </div>
            </div>

            <!-- TIER 3: Development & Talent -->
            <div class="tier-label">/// CONTRIBUTORS</div>

            <div class="tier-grid">
                <!-- ernestosabella -->
                <div class="team-card rank-dev">
                    <div class="pfp-wrapper">
                        <img src="https://cdn.discordapp.com/avatars/163771270125715458/df3d5dcce95da34655db8d8fd8933364.png?size=512" alt="ernestosabella">
                    </div>
                    <span class="role-badge">Dev & Presenter</span>
                    <h3 class="member-name">ernestosabella</h3>
                    <p class="member-bio">
                        Code contributor and on-air personality. Bringing technical expertise and live entertainment to the frequency.
                    </p>
                </div>
            </div>
        </div>
    </div>
    <!-- END TEAM WRAPPER -->


    <!-- Footer -->
    <footer>
        <p style="font-family: 'JetBrains Mono';">&copy; 2026 Pulse Radio Systems.</p>
        <div class="socials">
            <a href="#"><i class="fab fa-twitter"></i></a>
            <a href="#"><i class="fab fa-github"></i></a>
        </div>
    </footer>

    <!-- HTTP Warning -->
    <div class="warning-popup" id="warningPopup">
        <div style="display:flex; gap: 15px; align-items: flex-start;">
            <i class="fas fa-shield-alt" style="font-size: 1.5rem; margin-top: 2px;"></i>
            <div>
                <strong>Security Block Detected</strong>
                <div style="font-size: 0.85rem; margin-top: 5px; opacity: 0.9;">
                    Browser blocked HTTP stream. Click the ðŸ”’ lock icon in URL bar > Site Settings > Insecure Content > <strong>Allow</strong>.
                </div>
            </div>
        </div>
    </div>

    <script>
        const audio = document.getElementById("stream");
        const icon = document.getElementById("icon");
        const status = document.getElementById("status");
        const card = document.getElementById("playerCard");
        const playBtn = document.getElementById("playButton");
        const popup = document.getElementById("warningPopup");
        const volumeSlider = document.getElementById("volumeSlider");
        const songTitle = document.getElementById("songTitle");
        const songArtist = document.getElementById("songArtist");
        const listenerCountEl = document.getElementById("listenerCount");

        const STREAM_URL = 'https://stream.lemmo.app/listen/pulse_radio/radio.mp3';

        let isPlaying = false;
        let isConnecting = false;
        let updateInterval;

        audio.volume = 0.5;

        volumeSlider.addEventListener("input", (e) => {
            audio.volume = e.target.value;
        });

      function showSection(sectionId) {
    // 1. SAFEGUARD: Check if target exists first
    const targetSection = document.getElementById(`section-${sectionId}`);
    if (!targetSection) {
        console.error(`Error: Section "section-${sectionId}" not found!`);
        return;
    }

    // 2. Hide all sections
    document.querySelectorAll('.view-section').forEach(el => el.classList.add('hidden'));
    
    // 3. Show target section
    targetSection.classList.remove('hidden');

    // 4. Update Nav Active State (Safe Mode)
    document.querySelectorAll('.nav-links a').forEach(el => el.classList.remove('active'));
    
    const activeNav = document.getElementById(`nav-${sectionId}`);
    if (activeNav) {
        activeNav.classList.add('active');
    } else {
        // Fallback: If clicked from "Tune In" or "About", maybe highlight Home?
        const homeNav = document.getElementById('nav-home');
        if (homeNav) homeNav.classList.add('active');
    }

    // 5. Scroll to top
    window.scrollTo(0,0);
}

        function handlePlayClick() {
            if (isConnecting) return;
            toggleAudio();
        }

        async function toggleAudio() {
            if (isPlaying) {
                // STOP
                audio.pause();
                audio.src = ""; 
                audio.load(); 
                
                isPlaying = false;
                isConnecting = false;
                
                icon.className = "fas fa-play";
                playBtn.classList.remove("active");
                playBtn.disabled = false;
                status.innerText = "System Standby";
                card.classList.remove("playing");
                songTitle.innerText = "Stream Paused";
                songArtist.innerText = "Pulse Radio";
                clearInterval(updateInterval);
            } else {
                // START
                isConnecting = true;
                
                playBtn.disabled = true;
                icon.className = "fas fa-spinner fa-spin";
                status.innerText = "Establishing Connection...";
                songTitle.innerText = "Buffering Stream...";
                songArtist.innerText = "Please wait";

                audio.src = `${STREAM_URL}?t=${Date.now()}`;
                audio.load();

                attemptPlay(0);
            }
        }

        async function attemptPlay(retryCount) {
            try {
                await audio.play();
                
                isPlaying = true;
                isConnecting = false;
                
                playBtn.disabled = false;
                icon.className = "fas fa-pause";
                playBtn.classList.add("active");
                status.innerText = "/// LIVE SIGNAL RECEIVED";
                card.classList.add("playing");
                
                popup.style.display = 'none';

                updateNowPlaying();
                updateInterval = setInterval(updateNowPlaying, 10000);

            } catch (err) {
                console.warn(`Connection attempt ${retryCount + 1} failed`);
                if (retryCount < 10) { 
                    status.innerText = `Retrying Connection (${retryCount + 1})...`;
                    setTimeout(() => {
                        audio.load(); 
                        attemptPlay(retryCount + 1);
                    }, 1000);
                } else {
                    isConnecting = false;
                    isPlaying = false;
                    playBtn.disabled = false;
                    icon.className = "fas fa-exclamation-triangle";
                    status.innerText = "CONNECTION FAILURE";
                    songTitle.innerText = "Stream Blocked";
                    songArtist.innerText = "Check Security Settings";
                    popup.style.display = 'block';
                }
            }
        }

async function updateNowPlaying() {
    try {
        // 1. Fetch from AzuraCast API (Use stream.lemmo.app)
        const response = await fetch('https://stream.lemmo.app/api/nowplaying/1');
        const data = await response.json();

        // 2. Check if data is valid
        if (data && data.now_playing) {
            
            // --- Update Song Info ---
            const song = data.now_playing.song;
            if (song.title && song.artist) {
                songTitle.innerText = song.title;
                songArtist.innerText = song.artist;
            } else {
                // Fallback
                songTitle.innerText = song.text || "Pulse Radio";
                songArtist.innerText = "Live Stream";
            }

            // --- Update Listener Count ---
            const listeners = data.listeners.total;
            if (listenerCountEl) {
                listenerCountEl.innerHTML = `<i class="fas fa-users"></i> ${listeners} Tuned In`;
            }

            // --- Update Lock Screen Art ---
            if ('mediaSession' in navigator) {
                navigator.mediaSession.metadata = new MediaMetadata({
                    title: songTitle.innerText,
                    artist: songArtist.innerText,
                    album: "Pulse Radio Live",
                    artwork: [
                        { src: song.art || 'https://lemmo.app/static/img/generic_song.jpg', sizes: '96x96', type: 'image/jpeg' }
                    ]
                });
            }
        }
    } catch (error) {
        console.warn('Metadata update failed:', error);
    }
}

// 3. START IT IMMEDIATELY (This was missing!)
updateNowPlaying(); 
setInterval(updateNowPlaying, 10000); // Check every 10 seconds

if ('mediaSession' in navigator) {
    navigator.mediaSession.setActionHandler('play', () => { if(!isPlaying) handlePlayClick(); });
    navigator.mediaSession.setActionHandler('pause', () => { if(isPlaying) handlePlayClick(); });
    navigator.mediaSession.setActionHandler('stop', () => { if(isPlaying) handlePlayClick(); });
}
    </script>
</body>
</html>
